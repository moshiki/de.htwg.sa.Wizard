version: '3.0'
services:
  root:
    image: wizard-root:latest
    hostname: root
    working_dir: /wizard
    tty: true
    ports:
      - "1233:1233"
    depends_on:
      - rootdb
      - cardmodule
      - resulttablemodule
    #links:
    #  - rootdb
    environment:
      - DATABASE_HOST=rootdb:3306
    #command: ["./wait-for-it.sh", "-t", "60", "rootdb:3306", "--", "java -jar Wizard-assembly-SAR-6.jar"]
    command: ./wait-for-it.sh -t 60 rootdb:3306 -- java -jar Wizard-assembly-SAR-6.jar

  rootdb:
    image: wizard-root-mysql:latest
    hostname: rootdb

  cardmodule:
    image: wizard-cardmodule:latest
    hostname: cardmodule
    working_dir: /wizard
    depends_on:
      - cardmoduledb
    #links:
     # - cardmoduledb
    environment:
      - DATABASE_HOST=cardmoduledb:3306
    command: ./wait-for-it.sh -t 60 cardmoduledb:3306 -- java -jar CardModule-assembly-SAR-6.jar

  cardmoduledb:
    image: wizard-cardmodule-mysql:latest
    hostname: cardmoduledb

  resulttablemodule:
    image: wizard-resulttablemodule:latest
    #hostname: resulttablemodule
    working_dir: /wizard
    depends_on:
      - resulttablemoduledb
    #links:
    #  - resulttablemoduledb
    environment:
      - DATABASE_HOST=resulttablemoduledb:3306
    #command: ["./wait-for-it.sh", "-t", "60", "resulttablemoduledb:3306", "--", "java -jar ResultTableModule-assembly-SAR-6.jar"]
    #command: ./wait-for-it.sh -t 60 resulttablemoduledb:3306 -- java -jar ResultTableModule-assembly-SAR-6.jar
    command: ./wait-for-it.sh -t 60 resulttablemoduledb:3306 -- java -jar ResultTableModule-assembly-SAR-6.jar

  resulttablemoduledb:
    image: wizard-resulttablemodule-mysql:latest
    hostname: resulttablemoduledb
